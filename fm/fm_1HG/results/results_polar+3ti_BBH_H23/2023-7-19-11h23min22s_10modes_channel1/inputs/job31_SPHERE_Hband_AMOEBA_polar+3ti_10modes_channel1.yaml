## FOLDER AND FILE NAMES ##
SAVINGDIR: 'results/results_polar+3ti_BBH_H23/'
DATADIR: '/Users/desgranc/Documents/work/projects/HD120326/'
PREPROCESS: ['data/prereduced/convert/IRDIS/HIP 67497_BB_H_2019-07-09_ird_convert_recenter_dc2021_BEAST_307407/ird_convert_recenter_dc2021-',  'data/prereduced/convert/IRDIS/HIP 67497_DB_H23_2016-04-05_ird_convert_recenter_dc5_PUBLIC_204546/ird_convert_recenter_dc5-',  'data/prereduced/convert/IRDIS/HIP 67497_DB_H23_2016-06-03_ird_convert_recenter_dc5_PUBLIC_208510/ird_convert_recenter_dc5-', None]
POSTPROCESS: ['data/reduced/PCA_Celia/fits/',   'data/reduced/PCA_Celia/fits/',   'data/reduced/PCA_Celia/fits/',  'data/reduced/IRDAP/2018-06-01/']

FN_SCIENCE: ['IRD_SCIENCE_REDUCED_MASTER_CUBE-center_im.fits',  'IRD_SCIENCE_REDUCED_MASTER_CUBE-center_im.fits',  'IRD_SCIENCE_REDUCED_MASTER_CUBE-center_im.fits',  'reduced_pdi/star_pol_subtr/HIP67497_2018-06-02_Q_phi_star_pol_subtr.fits']
FN_NOISE:  ['center_im_std_noise_map.fits', 'center_im_std_noise_map.fits', 'center_im_std_noise_map.fits', 'reduced_pdi/star_pol_subtr/HIP67497_2018-06-02_U_phi_star_pol_subtr_annuli.fits']
FN_MASK: '/Users/desgranc/Documents/work/GitHub_clone/projects/HD102326/fm/inputs/mask_inner_belt_2019-07-09_IRDIS.reg'

FN_PSF: ['IRD_SCIENCE_PSF_MASTER_CUBE-median_unsat.fits', 'IRD_SCIENCE_PSF_MASTER_CUBE-median_unsat.fits', 'IRD_SCIENCE_PSF_MASTER_CUBE-median_unsat.fits', None]
FN_PSF_LEFT: 'calibration/flux/HIP67497_2018-06-02_cube_flux_processed_left.fits'
FN_PSF_RIGHT: 'calibration/flux/HIP67497_2018-06-02_cube_flux_processed_right.fits'

FN_PA: ['IRD_SCIENCE_PARA_ROTATION_CUBE-rotnth.fits', 'IRD_SCIENCE_PARA_ROTATION_CUBE-rotnth.fits', 'IRD_SCIENCE_PARA_ROTATION_CUBE-rotnth.fits', None]


## PARAMETERS ##
# SYSTEM PARAMETER
DISTANCE_STAR: 113.27 #107

# OBSERVATION PARAMETERS
EPOCH: 2019-07-09
NOBS: 4
TYPE_OBS: ['total_intensity','total_intensity','total_intensity','polar']
IBAND: 0 # channel considered
OWA: 1024
PIXSCALE_INS: 0.012255 # sphere pixel scale

# PROCESSING PARAMETERS
ALGO: PCA
CROP_SCIENCE: [412,412,412,412] # times two
CROP_NOISE: [0,0,0,412] 
CROP_PSF: [20,20,20,500]  # times two

NMODES: 10 # number of modes used to apply the PCA
MASK_RAD: 7
METH_NOISE: 'compute_it'
SCIENCE_NORM: 1 # to convert in contrast # value taken from the .csv table from Rob van Holstein (polar data)

COMBINED: 0

## MODELLING ##
exploration_algo: "AMOEBA" # "MCMC" or "AMOEBA"
SAVE_INTERMEDIATE_RESULTS: True
SAVE_DETAIL_RESULTS: True

# INITIAL MODEL PARAMETERS
PARAMS_TO_FIT: "6 params: a, PA, inc, g, (flux) scaling 1, (flux) scaling 2"
bounds: [(20,50),(0,180), (100, 130), (0,1), (0,None)]
# [5.61806436e+01 9.37366501e+01 8.15627349e+01 8.58207318e-01 2.45594512e+04
# [5.67413658e+01 9.39214076e+01 8.16835343e+01 9.04455525e-013.54486183e+04] 

Nparams_to_fit: 5

rad_init: 47.8073815 
pa_init:  93.8797679 
inc_init: 78.9326218 
g1_init:  0.796442430
scaling1: 26411.7050 
scaling2: 14600
scaling3: 14700
scaling4: 1393404.61

aout_init:  -5
ain_init: 10 #10

argperi_init: 0.001 #None
ecc_init: 0.001 #None
ksi0_init: 0.1756

g2_init: None
alpha_init: 0.5 # weight between g1 and g2  #0.31
beta_init: 1  # 1 = flaring
gamma_init: 2 # 2 = gaussian; if gamma small: the scale height is very spanned. If gamma large, the disk is very compact

N_init: 1400


## MCMC PARAMETERS ##
NEW_BACKEND: 1
#if NEW_BACKEND=0, reset the backend, if not, start where you stopped
NWALKERS: 25 #Number of walkers
N_ITER_MCMC: 2 #Number of interation
NOISE_MULTIPLICATION_FACTOR: 5 # multiplicative factor for the noise
N_DIM_MCMC: 5  #Number of parameter in the MCMC

# MCMC READING PARAMETERS This is only used in the plotting part
BURNIN: 0      #We remove the first BURNIN iteration. 
THIN: 1       #thin (bin) the chains
QUALITY_PLOT: 4
sigma: 1


NAMES:
- Rad
- ain
- aout
- inc
- PA
- Argpe
- ecc
- ksi0
- g1
- g2
- Alph
- Norm
- Rmas

# - Omega
# - ekowa
# - ikowa
# - RA
# - Decl
# - RAp
# - Declp
# - Rkowa


LABELS:
  Alph: $\alpha$
  ain: $Ain$
  aout: $Aout$
  Norm: N[ADU]
  PA: $pa[^{\circ}]$
  Rad: R[AU]
  g1: g1
  g2: g2
  inc: $i[^{\circ}]$
  Argpe: Argpe[^{\circ}]
  ecc: ecc
  ksi0: Ksi_0


COMMENTS:
  Argpe: ' deg, argument of pericentre'
  Alph: ' relative HG weight'
  ain: ' radial inner power law'
  aout: ' radial outer power law'
  Norm: ' ADU, normalisation'
  PA: ' degree, principal angle'
  Rad: ' AU, disk radius'
  ecc: ' eccentricity'
  ksi0: ' au, scale height at the reference radius'
  g1: ' 1st HG param'
  g2: ' 2nd HG param'
  inc: ' degree, inclination'
  Rmas: ' mas, disk radius'

