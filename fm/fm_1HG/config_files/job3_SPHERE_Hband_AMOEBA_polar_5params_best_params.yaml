## FOLDER AND FILE NAMES ##
SAVINGDIR: 'results/results_polar/'
DATADIR: '/Users/desgranc/Documents/work/projects/HD120326/'
PREPROCESS: 'data/prereduced/' # unuseful for polar IRDIS
POSTPROCESS: 'data/reduced/IRDAP/2018-06-01/'

FN_SCIENCE: 'reduced_pdi/star_pol_subtr/HIP67497_2018-06-02_Q_phi_star_pol_subtr.fits'
FN_NOISE:  'reduced_pdi/star_pol_subtr/HIP67497_2018-06-02_U_phi_star_pol_subtr_annuli.fits'
FN_MASK: '/Users/desgranc/Documents/work/GitHub_clone/projects/HD102326/fm/inputs/mask_IRDAP.fits'

FN_PSF_LEFT: 'calibration/flux/HIP67497_2018-06-02_cube_flux_processed_left.fits'
FN_PSF_RIGHT: 'calibration/flux/HIP67497_2018-06-02_cube_flux_processed_right.fits'

## PARAMETERS ##
# SYSTEM PARAMETER
DISTANCE_STAR: 113.27 #107

# OBSERVATION PARAMETERS
EPOCH: 2018-06-01
TYPE_OBS: 'polar'
IBAND: 0 # channel considered
OWA: 1024
PIXSCALE_INS: 0.012255 # sphere pixel scale

# PROCESSING PARAMETERS
ALGO: PCA
CROP_SCIENCE: 412 # times two
CROP_NOISE: 412 # times two; for polar images reduced by IRDAP, should be equal to CROP_SCIENCE, otherwise should be set to 0
CROP_PSF: 500 # times two

NMODES: 5 # number of modes used to apply the PCA
MASK_RAD: 4
METH_NOISE: 'compute_it'
SCIENCE_NORM: 1 # to convert in contrast # value taken from the .csv table from Rob van Holstein (polar data)

COMBINED: 0

## MODELLING ##
exploration_algo: "AMOEBA" # "MCMC" or "AMOEBA"
SAVE_INTERMEDIATE_RESULTS: True
SAVE_DETAIL_RESULTS: True

# INITIAL MODEL PARAMETERS
PARAMS_TO_FIT: "5 params: a, PA, inc, g, (flux) scaling"
bounds: [(20,50),(0,180), (100, 130), (0,1), (0,None)]

#[3.77981830e+01 9.30717653e+01 7.66730876e+01 6.98064489e-01 5.67921068e+05]
 
rad_init: 55 #37.8
pa_init: 93.1
inc_init: 76.7 #103.3 #76.7
g1_init: 0.7
scaling: 568000 # flux

aout_init:  -2 #-5
ain_init: 14 #10

argperi_init: 0.001 #None
ecc_init: 0.001 #None
ksi0_init: 0.1756

g2_init: None
alpha_init: 0.5 # weight between g1 and g2  #0.31
beta_init: 1  # 1 = flaring
gamma_init: 2 # 2 = gaussian; if gamma small: the scale height is very spanned. If gamma large, the disk is very compact

N_init: 1400


## MCMC PARAMETERS ##
NEW_BACKEND: 1
#if NEW_BACKEND=0, reset the backend, if not, start where you stopped
NWALKERS: 25 #Number of walkers
N_ITER_MCMC: 2 #Number of interation
NOISE_MULTIPLICATION_FACTOR: 5 # multiplicative factor for the noise
N_DIM_MCMC: 5  #Number of parameter in the MCMC

# MCMC READING PARAMETERS This is only used in the plotting part
BURNIN: 0      #We remove the first BURNIN iteration. 
THIN: 1       #thin (bin) the chains
QUALITY_PLOT: 4
sigma: 1


NAMES:
- Rad
- ain
- aout
- inc
- PA
- Argpe
- ecc
- ksi0
- g1
- g2
- Alph
- Norm
- Rmas

# - Omega
# - ekowa
# - ikowa
# - RA
# - Decl
# - RAp
# - Declp
# - Rkowa


LABELS:
  Alph: $\alpha$
  ain: $Ain$
  aout: $Aout$
  Norm: N[ADU]
  PA: $pa[^{\circ}]$
  Rad: R[AU]
  g1: g1
  g2: g2
  inc: $i[^{\circ}]$
  Argpe: Argpe[^{\circ}]
  ecc: ecc
  ksi0: Ksi_0


COMMENTS:
  Argpe: ' deg, argument of pericentre'
  Alph: ' relative HG weight'
  ain: ' radial inner power law'
  aout: ' radial outer power law'
  Norm: ' ADU, normalisation'
  PA: ' degree, principal angle'
  Rad: ' AU, disk radius'
  ecc: ' eccentricity'
  ksi0: ' au, scale height at the reference radius'
  g1: ' 1st HG param'
  g2: ' 2nd HG param'
  inc: ' degree, inclination'
  Rmas: ' mas, disk radius'

